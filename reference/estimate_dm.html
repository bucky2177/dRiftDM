<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit a DDM to Observed Data — estimate_dm • dRiftDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a DDM to Observed Data — estimate_dm"><meta name="description" content="estimate_dm() is the main function to fit a drift diffusion model (DDM)
in dRiftDM. Several ways of fitting a model are supported: fitting a single
participant, fitting multiple participants separately or aggregated, and
fitting a (hierarchical) Bayesian model. The particular way is controlled
via the approach argument."><meta property="og:description" content="estimate_dm() is the main function to fit a drift diffusion model (DDM)
in dRiftDM. Several ways of fitting a model are supported: fitting a single
participant, fitting multiple participants separately or aggregated, and
fitting a (hierarchical) Bayesian model. The particular way is controlled
via the approach argument."><meta property="og:image" content="https://bucky2177.github.io/dRiftDM/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dRiftDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dRiftDM.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/convert_dmc_parameters.html">How to Convert DMC's parameters</a></li>
    <li><a class="dropdown-item" href="../articles/customize_ddms.html">How To Customize DDMs</a></li>
    <li><a class="dropdown-item" href="../articles/model_recovery.html">How To Perform a Model Recovery</a></li>
    <li><a class="dropdown-item" href="../articles/predictions_simple_ddm.html">Core DDM Parameters: Impact on RTs and Accuracy</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bucky2177/dRiftDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit a DDM to Observed Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/bucky2177/dRiftDM/blob/v0.3.0_last/R/core_estimate.R" class="external-link"><code>R/core_estimate.R</code></a>, <a href="https://github.com/bucky2177/dRiftDM/blob/v0.3.0_last/R/formatting_fits_agg_dm.R" class="external-link"><code>R/formatting_fits_agg_dm.R</code></a>, <a href="https://github.com/bucky2177/dRiftDM/blob/v0.3.0_last/R/formatting_fits_ids_dm.R" class="external-link"><code>R/formatting_fits_ids_dm.R</code></a>, and 1 more</small>
      <div class="d-none name"><code>estimate_dm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>estimate_dm()</code> is the main function to fit a drift diffusion model (DDM)
in <code>dRiftDM</code>. Several ways of fitting a model are supported: fitting a single
participant, fitting multiple participants separately or aggregated, and
fitting a (hierarchical) Bayesian model. The particular way is controlled
via the <code>approach</code> argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_dm</span><span class="op">(</span></span>
<span>  <span class="va">drift_dm_obj</span>,</span>
<span>  obs_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  approach <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  parallelization_strategy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_vals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shapes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_chains <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  burn_in <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  prob_migration <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  prob_re_eval <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  messaging <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'fits_agg_dm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'fits_ids_dm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mcmc_dm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, round_digits <span class="op">=</span> <span class="fu"><a href="defaults.html">drift_dm_default_rounding</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-drift-dm-obj">drift_dm_obj<a class="anchor" aria-label="anchor" href="#arg-drift-dm-obj"></a></dt>
<dd><p>a <a href="drift_dm.html">drift_dm</a> object containing the model to be
fitted.</p></dd>


<dt id="arg-obs-data">obs_data<a class="anchor" aria-label="anchor" href="#arg-obs-data"></a></dt>
<dd><p>an optional <a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a> (see also <a href="obs_data.html">obs_data</a>).
If no <code>ID</code> column is present, a single-individual setup is assumed.
If an <code>ID</code> column is present, the model is fitted separately for each
individual.</p></dd>


<dt id="arg-approach">approach<a class="anchor" aria-label="anchor" href="#arg-approach"></a></dt>
<dd><p>an optional character string, specifying the approach to
fitting the model. Options are <code>"sep_c"</code>, <code>"agg_c"</code>, <code>"sep_b"</code>, <code>"hier_b"</code>
(see the Details).</p></dd>


<dt id="arg-optimizer">optimizer<a class="anchor" aria-label="anchor" href="#arg-optimizer"></a></dt>
<dd><p>a character string. For classical optimization, one of
<code>"nmkb"</code>, <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"L-BFGS-B"</code>, <code>"DEoptim"</code>. For the
Bayesian framework, only <code>"DE-MCMC"</code> is currently supported. If <code>NULL</code> and
if a classical optimization approach is used, defaults to <code>"DEoptim"</code> or
<code>"Nelder-Mead"</code>, depending on whether <code>lower/upper</code> are provided or not. If
<code>NULL</code> and if a Bayesian framework is used, defaults to <code>"DE-MCMC</code>.
Note that <code>"BFGS"</code> and <code>"L-BFGS-B"</code> are often unstable.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a list of control parameters passed to the optimizer
(for Nelder-Mead, BFGS, and L-BFGS-B, see <a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a>; for nmkb, see
<a href="https://rdrr.io/pkg/dfoptim/man/nmkb.html" class="external-link">dfoptim::nmkb</a>; for DEoptim, see <a href="https://rdrr.io/pkg/DEoptim/man/DEoptim.html" class="external-link">DEoptim::DEoptim</a>).
Per default, we set the <code>trace</code> control argument for <a href="https://rdrr.io/pkg/DEoptim/man/DEoptim.html" class="external-link">DEoptim::DEoptim</a> to
<code>FALSE</code>. Also, we set the <code>parscale</code> control argument for "Nelder-Mead" via
<a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a> to <code>pmax(x0, 1e-6)</code>.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>an integer &gt; 0, indicating the number of CPU cores/threads to
use (at the moment, this doesn't have an effect when fitting a single
individual within the Bayesian framework).</p></dd>


<dt id="arg-parallelization-strategy">parallelization_strategy<a class="anchor" aria-label="anchor" href="#arg-parallelization-strategy"></a></dt>
<dd><p>an integer, controlling how parallelization
is performed when fitting multiple individuals with the classical approach.
If <code>1</code>, parallelization is across individuals. If <code>2</code>, parallelization is
within individuals (currently only supported for <code>"DEoptim"</code>). Defaults to
<code>1</code>.</p></dd>


<dt id="arg-lower-upper">lower, upper<a class="anchor" aria-label="anchor" href="#arg-lower-upper"></a></dt>
<dd><p>numeric vectors or lists, specifying the lower and upper
bounds on each parameter to be optimized (see Details).</p></dd>


<dt id="arg-start-vals">start_vals<a class="anchor" aria-label="anchor" href="#arg-start-vals"></a></dt>
<dd><p>optional starting values for classical single-subject fits
and when using an optimizer that requires a starting value. Can be
a numeric vector of model parameters when fitting a single individual, or
a <code>data.frame</code> with columns for each model parameter. In the latter case,
enables multi-start (one row per start). For <code>'approach = "separately"'</code>, a
<code>data.frame</code> with an <code>ID</code> column is required.</p></dd>


<dt id="arg-means-sds-shapes-rates">means, sds, shapes, rates<a class="anchor" aria-label="anchor" href="#arg-means-sds-shapes-rates"></a></dt>
<dd><p>optional numeric vectors for prior
specification (when using the Bayesian framework, see Details).</p></dd>


<dt id="arg-n-chains">n_chains<a class="anchor" aria-label="anchor" href="#arg-n-chains"></a></dt>
<dd><p>an integer, providing the number of MCMC chains (Bayesian
framework).</p></dd>


<dt id="arg-burn-in">burn_in<a class="anchor" aria-label="anchor" href="#arg-burn-in"></a></dt>
<dd><p>an integer, number of burn-in iterations (Bayesian
framework).</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>an integer, number of post-burn-in samples per chain (
Bayesian framework).</p></dd>


<dt id="arg-prob-migration">prob_migration<a class="anchor" aria-label="anchor" href="#arg-prob-migration"></a></dt>
<dd><p>a numeric in <code>[0,1]</code>, controlling the migration
probability of the <code>DE-MCMC</code> algorithm (Bayesian framework).</p></dd>


<dt id="arg-prob-re-eval">prob_re_eval<a class="anchor" aria-label="anchor" href="#arg-prob-re-eval"></a></dt>
<dd><p>a numeric in <code>[0,1]</code>, probability to re-evaluate the
model at current group-level parameters during sampling (Bayesian
framework; only relevant for the hierarchical case).</p></dd>


<dt id="arg-messaging">messaging<a class="anchor" aria-label="anchor" href="#arg-messaging"></a></dt>
<dd><p>a logical, if <code>TRUE</code> progress/info messages are printed</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>an optional integer to set the RNG seed for reproducibility.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments forwarded to lower-level routines. Options
are: <code>progress/verbose</code> (integers, for controlling progress bars and
verbosity of estimation infos), <code>round_digits</code> (for controlling the number
of digits for rounding when printing individual model evaluations;
if <code>verbose = 2</code>), <code>return_runs</code>
(when fitting a single individual and starting the estimation
routine with multiple starting points; if <code>TRUE</code>, then a list of all
routines is returned), <code>probs/n_bins</code> (the quantile levels and the number
of CAF bins when fitting aggregated data using the RMSE cost function),
<code>use_ez/n_lhs</code> (logical and integer; the first controls if EZ-Diffusion
Parameter Estimates shall be used for determining starting points; the
latter controls the number of parameters to sample per dimension for the
latin hypercube sampling when searching for starting values)</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of type <code>fits_agg_dm</code>, <code>fits_ids_dm</code>, or <code>mcmc_dm</code></p></dd>


<dt id="arg-round-digits">round_digits<a class="anchor" aria-label="anchor" href="#arg-round-digits"></a></dt>
<dd><p>integer, specifying the number of decimal places for
rounding in the printed summary. Default is 3.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p>If fitting a single individual: either a <code>drift_dm</code> object with
fitted parameters and additional fit information (for the classical
optimization framework) or an object of type <code>mcmc_dm</code> (for the Bayesian
framework)</p></li>
<li><p>If fitting multiple individuals separately: a <code>fits_ids_dm</code> object
or a list of <code>mcmc_dm</code> objects, containing all the individual model fits.</p></li>
<li><p>If fitting aggregated data: a <code>fits_agg_dm</code> object containing the model
itself and the raw data.</p></li>
<li><p>If fitting multiple individuals hierarchically: an object of type
<code>mcmc_dm</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="fitting-approaches">Fitting Approaches<a class="anchor" aria-label="anchor" href="#fitting-approaches"></a></h3>


<p>The function supports different "approaches" to fitting data.</p><ul><li><p><code>"sep_c"</code>: This means that data is always considered <code>sep</code>arately for
each participant (if there are multiple participants) and that a
<code>c</code>lassical approach to parameter optimization is used. This means that
a standard <a href="cost_function.html">cost_function</a> is minimized (e.g., the negative
log-likelihood). If users provide only a single participant or a data set
without an <code>ID</code> column, then the model is fitted just once to that data
set.</p></li>
<li><p><code>"agg_c"</code>: This fits the model to aggregated data. For each individual in
a data set, summary statistics (e.g., quantiles, accuracies) are
calculated, and the model is fitted once to the average of these summary
statistics.</p></li>
<li><p><code>"sep_b"</code>: Similar to <code>sep_b"</code>, although a Bayesian approach is used to
sample from the posterior distribution.</p></li>
<li><p><code>"hier_b"</code>: A hierarchical approach to parameter estimation. In this case
all participants are considered simultaneously and samples are drawn both
at the individual-level and group-level.</p></li>
</ul><p>The optimizers  <code>"nmkb"</code>, <code>"L-BFGS-B"</code>, and <code>"DEoptim"</code> (for classical
parameter optimization) require the specification of the <code>lower/upper</code>
arguments.</p>
</div>

<div class="section">
<h3 id="fitting-to-aggregated-data">Fitting to Aggregated Data<a class="anchor" aria-label="anchor" href="#fitting-to-aggregated-data"></a></h3>


<p>For aggregated fits, aggregated statistics are set to the model and the cost
function is switched to <code>"rmse"</code>. If incompatible settings are requested,
the function switches to a compatible configuration and informs the user
with messages (these messages can be suppressed via the <code>messaging</code> argument).</p>
</div>

<div class="section">
<h3 id="specifying-lower-upper-for-classical-optimization">Specifying <code>lower/upper</code> for Classical optimization<a class="anchor" aria-label="anchor" href="#specifying-lower-upper-for-classical-optimization"></a></h3>


<p>the function <code>estimate_model_dm()</code> provides a flexible way of specifying the
optimization space; this is identical to specifying the parameter simulation
space in <code><a href="simulate_data.html">simulate_data.drift_dm()</a></code>.</p>
<p>Users have three options to specify the search space (see also the examples
below):</p><ul><li><p>Plain numeric vectors (not very much recommended). In this case,
<code>lower/upper</code> must be sorted in accordance with the parameters in the
underlying <a href="flex_prms.html">flex_prms</a> object of <code>drift_dm_obj</code> that vary for at
least one condition (call <code>print(drift_dm_obj)</code> and have a look at the
columns of the <code>Parameter Settings</code> output; for each column that has a
number &gt; 0, specify an entry in <code>lower/upper</code>).</p></li>
<li><p>Named numeric vectors. In this case <code>lower/upper</code> have to provide labels
in accordance with the parameters that are considered "free" at least once
across conditions (call <code>coef(drift_dm_obj)</code> and provide one named entry for
each parameter; dRiftDM will try to recycle parameter values across
conditions).</p></li>
<li><p>The most precise way is when <code>lower/upper</code> are lists. In this case, the
list requires an entry called "default_values" which specifies the named or
plain numeric vectors as above. If the list only contains this entry, then
the behavior is as if <code>lower/upper</code> were already numeric vectors. However,
the <code>lower/upper</code> lists can also provide entries labeled as specific
conditions, which contain named (!) numeric vectors with parameter labels.
This will modify the value for the upper/lower parameter space with respect
to the specified parameters in the respective condition.</p></li>
</ul></div>

<div class="section">
<h3 id="specifying-priors-for-bayesian-estimation">Specifying Priors for Bayesian Estimation<a class="anchor" aria-label="anchor" href="#specifying-priors-for-bayesian-estimation"></a></h3>


<p><strong>(Default) Prior settings in the non-hierarchical case:</strong></p>
<p>Let \(\theta^{(j)}\) indicate parameter \(j\) of a model (e.g., the
drift rate).
The prior on \(\theta^{(j)}\) is a truncated normal distribution:
$$
 \theta^{(j)} \sim NT(\mu^{(j)}, \sigma^{(j)}, l^{(j)}, u^{(j)})
 $$
With \(\mu^{(j)}\) and \(\sigma^{(j)}\) representing the mean and standard
deviation of parameter \(j\). \(l^{(j)}\) and \(u^{(j)}\) represent the
lower and upper boundary. \(\mu^{(j)}\) is taken from the <code>mean</code>
argument or the currently set model parameters (i.e., from
<code>coef(drift_dm_obj)</code>) when calling the function. \(\sigma^{(j)}\) is, per
default, equal to \(\mu^{(j)}\). This can be changed by passing
the <code>sd</code> argument. The lower and upper boundaries of the truncated normal
are <code>-Inf</code> and <code>Inf</code> per default. This can be altered by passing the
arguments <code>lower</code> and  <code>upper</code> (see the examples below).</p>
<p><strong>(Default) Prior settings in the hierarchical case:</strong></p>
<p>Let \(\theta_i^{(j)}\) indicate parameter \(j\) for participant \(i\)
(e.g., the  drift rate estimated for individual \(i\)). The prior on
\(\theta_i^{(j)}\) is a truncated normal distribution:
$$
 \theta_i^{(j)} \sim NT(\mu^{(j)}, \sigma^{(j)}, l^{(j)}, u^{(j)})
 $$
With \(\mu^{(j)}\) and \(\sigma^{(j)}\) representing the mean and
standard deviation of parameter \(j\) at the group level. \(l^{(j)}\) and
\(u^{(j)}\) represent the lower and upper boundary. The lower and upper
boundaries of the truncated normal are <code>-Inf</code> and <code>Inf</code> per default.
This can be altered by passing the arguments <code>lower</code> and  <code>upper</code>.</p>
<p>For a group-level mean parameter, \(\mu^{(j)}\), the prior is also a
truncated normal distributions:
$$
 \mu^{(j)} \sim NT(M^{(j)}, SD^{(j)}, l^{(j)}, u^{(j)})
 $$
With \(M^{(j)}\) specified by the <code>mean</code> argument or the currently
set model parameters. \(SD^{(j)}\) is, per default, equal to \(M^{(j)}\).
This can be changed by passing the <code>sd</code> argument.</p>
<p>For a group-level standard deviation parameter, \(\sigma^{(j)}\), the prior
is a gamma distribution:
$$
 \sigma^{(j)} \sim \Gamma(shape^{(j)},rate^{(j)})
 $$
With \(shape^{(j)}\) and \(rate^{(j)}\) being <code>1</code> by default. This
can be changed by passing the arguments <code>shape</code> and <code>rate</code>.</p>
<p><strong>Specifying Prior Settings/Arguments</strong></p>
<p>Argument specification for <code>mean</code>, <code>sd</code>, <code>lower</code>, <code>upper</code>, <code>shape</code> and
<code>rate</code> is conceptually identical to specifying <code>lower/upper</code> for the
classical optimization approach (see the subsection above and the examples
below).</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><code>estimate_dm</code> dispatches to underlying estimation routines that are not
exported:</p><ul><li><p>Classical optimization of one individual via
<code><a href="estimate_classical.html">estimate_classical()</a></code></p></li>
<li><p>Classical optimization of multiple individuals via
<code><a href="estimate_classical_wrapper.html">estimate_classical_wrapper()</a></code></p></li>
<li><p>Bayesian estimation via <code><a href="estimate_bayesian.html">estimate_bayesian()</a></code>.</p></li>
<li><p>Aggregated fitting is handled within <code>estimate_dm()</code> in combination with
<code><a href="estimate_classical.html">estimate_classical()</a></code></p></li>
</ul><p>When fitting a model with <code>optimizer = "DEoptim"</code>, the corresponding
minimization routine always runs for 200 iterations by default, irrespective
of whether a minimum has already been reached (see
<a href="https://rdrr.io/pkg/DEoptim/man/DEoptim.control.html" class="external-link">DEoptim::DEoptim.control</a>). Therefore, with default optimization settings,
<code>estimate_dm()</code> returns the convergence flag <code>NA</code> for
<code>optimizer = "DEoptim"</code>, because the termination of the routine does not
necessarily indicate convergence. However, this is typically not an issue, as
200 iterations are generally sufficient for the algorithm to find the global
minimum. If users explicitly define convergence criteria via the <code>control</code>
argument of <code>estimate_dm()</code> (which is passed on to
<a href="https://rdrr.io/pkg/DEoptim/man/DEoptim.control.html" class="external-link">DEoptim::DEoptim.control</a>), valid convergence messages and flags are
returned.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="estimate_classical.html">estimate_classical()</a></code>, <code><a href="estimate_bayesian.html">estimate_bayesian()</a></code>,
<code><a href="estimate_classical_wrapper.html">estimate_classical_wrapper()</a></code>, <code><a href="get_parameters_smart.html">get_parameters_smart()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##########</span></span></span>
<span class="r-in"><span><span class="co"># Note: The following examples were trimmed for speed to ensure they run</span></span></span>
<span class="r-in"><span><span class="co"># within seconds. They do not always provide realistic settings.</span></span></span>
<span class="r-in"><span><span class="co">##########</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####</span></span></span>
<span class="r-in"><span><span class="co"># Setup</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get a model for the examples (DMC with just two free parameters)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="dmc_dm.html">dmc_dm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  instr <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">   b &lt;!&gt;</span></span></span>
<span class="r-in"><span><span class="st">   non_dec &lt;!&gt;</span></span></span>
<span class="r-in"><span><span class="st">   sd_non_dec &lt;!&gt;</span></span></span>
<span class="r-in"><span><span class="st">   tau &lt;!&gt;</span></span></span>
<span class="r-in"><span><span class="st">   alpha &lt;!&gt;</span></span></span>
<span class="r-in"><span><span class="st">   "</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get some data (the first two participants in the data set of Ulrich et al.)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">ulrich_flanker_data</span><span class="op">[</span><span class="va">ulrich_flanker_data</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####</span></span></span>
<span class="r-in"><span><span class="co"># Fit a single individual (using unbounded Nelder-Mead)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate_dm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  drift_dm_obj <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  obs_data <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"Nelder-Mead"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the data supplied via the 'obs_data' argument.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using optimizer 'Nelder-Mead'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting a single data set/participant (cost function: 'neg_log_like'). The returned object will be the model itself.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using EZ-Diffusion estimates for: muc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing latin hypercube sampling (n_lhs = 10) on: A</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting optimizer 'Nelder-Mead' with the following starting values:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> muc=3.868, A=0.076</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimization routine exited after 91 function evaluations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final Parameters:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> muc = 4.608</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A = 0.081</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==&gt; gave a neg_log_like of -368.96</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class(es) dmc_dm, drift_dm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizer: Nelder-Mead</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          muc   b non_dec sd_non_dec  tau a      A alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp   4.608 0.6     0.3       0.02 0.04 2  0.081     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp 4.608 0.6     0.3       0.02 0.04 2 -0.081     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Settings:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        muc b non_dec sd_non_dec tau a A alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp   1   0 0       0          0   0 2 0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp 1   0 0       0          0   0 d 0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Special Dependencies:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A ~ incomp == -(A ~ comp)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Custom Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        peak_l</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp     0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp   0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deriving PDFS:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   solver: kfe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   values: sigma=1, t_max=3, dt=0.0075, dx=0.02, nt=400, nx=100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cost Function: neg_log_like</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed Data: 168 trials comp; 168 trials incomp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####</span></span></span>
<span class="r-in"><span><span class="co"># Fit a single individual (using bounded Nelder-Mead and custom starting</span></span></span>
<span class="r-in"><span><span class="co"># values)</span></span></span>
<span class="r-in"><span><span class="va">l_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_lower_upper.html">get_lower_upper</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate_dm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  drift_dm_obj <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  obs_data <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"nmkb"</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">l_u</span><span class="op">$</span><span class="va">lower</span>, upper <span class="op">=</span> <span class="va">l_u</span><span class="op">$</span><span class="va">upper</span>,</span></span>
<span class="r-in"><span>  start_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>muc <span class="op">=</span> <span class="fl">4</span>, A <span class="op">=</span> <span class="fl">0.06</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the data supplied via the 'obs_data' argument.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using optimizer 'nmkb'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting a single data set/participant (cost function: 'neg_log_like'). The returned object will be the model itself.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting optimizer 'nmkb' with the following starting values:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> muc=4, A=0.06</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimization routine exited after 94 function evaluations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final Parameters:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> muc = 4.608</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A = 0.081</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==&gt; gave a neg_log_like of -368.96</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class(es) dmc_dm, drift_dm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizer: nmkb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          muc   b non_dec sd_non_dec  tau a      A alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp   4.608 0.6     0.3       0.02 0.04 2  0.081     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp 4.608 0.6     0.3       0.02 0.04 2 -0.081     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Settings:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        muc b non_dec sd_non_dec tau a A alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp   1   0 0       0          0   0 2 0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp 1   0 0       0          0   0 d 0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Special Dependencies:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A ~ incomp == -(A ~ comp)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Custom Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        peak_l</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp     0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp   0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deriving PDFS:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   solver: kfe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   values: sigma=1, t_max=3, dt=0.0075, dx=0.02, nt=400, nx=100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cost Function: neg_log_like</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed Data: 168 trials comp; 168 trials incomp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####</span></span></span>
<span class="r-in"><span><span class="co"># Fit a single individual (using DEoptim)</span></span></span>
<span class="r-in"><span><span class="co"># Note: DEoptim always runs for 200 iterations per default; which is not</span></span></span>
<span class="r-in"><span><span class="co"># necessary here -&gt; in this simple example, we stop it after 10 iterations</span></span></span>
<span class="r-in"><span><span class="co"># without improvement</span></span></span>
<span class="r-in"><span><span class="va">l_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_lower_upper.html">get_lower_upper</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate_dm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  drift_dm_obj <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  obs_data <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"DEoptim"</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">l_u</span><span class="op">$</span><span class="va">lower</span>, upper <span class="op">=</span> <span class="va">l_u</span><span class="op">$</span><span class="va">upper</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>steptol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the data supplied via the 'obs_data' argument.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using optimizer 'DEoptim'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting a single data set/participant (cost function: 'neg_log_like'). The returned object will be the model itself.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting optimizer 'DEoptim' </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimization routine exited after 65 iterations.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final Parameters:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> muc = 4.608</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A = 0.081</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==&gt; gave a neg_log_like of -368.96</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class(es) dmc_dm, drift_dm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizer: DEoptim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          muc   b non_dec sd_non_dec  tau a      A alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp   4.608 0.6     0.3       0.02 0.04 2  0.081     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp 4.608 0.6     0.3       0.02 0.04 2 -0.081     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter Settings:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        muc b non_dec sd_non_dec tau a A alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp   1   0 0       0          0   0 2 0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp 1   0 0       0          0   0 d 0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Special Dependencies:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A ~ incomp == -(A ~ comp)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Custom Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        peak_l</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> comp     0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> incomp   0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deriving PDFS:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   solver: kfe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   values: sigma=1, t_max=3, dt=0.0075, dx=0.02, nt=400, nx=100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cost Function: neg_log_like</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observed Data: 168 trials comp; 168 trials incomp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####</span></span></span>
<span class="r-in"><span><span class="co"># Fit multiple individuals (separately; using bounded Nelder-Mead)</span></span></span>
<span class="r-in"><span><span class="va">l_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_lower_upper.html">get_lower_upper</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate_dm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  drift_dm_obj <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  obs_data <span class="op">=</span> <span class="va">data</span>, <span class="co"># contains the data for two individuals</span></span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"nmkb"</span>,</span></span>
<span class="r-in"><span>  lower <span class="op">=</span> <span class="va">l_u</span><span class="op">$</span><span class="va">lower</span>, upper <span class="op">=</span> <span class="va">l_u</span><span class="op">$</span><span class="va">upper</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the data supplied via the 'obs_data' argument.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using optimizer 'nmkb'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting the model separately to multiple participants (cost function:'neg_log_like'). The result will be a fit object of type 'fits_ids_dm'.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit approach: separately - classical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted model type: dmc_dm, drift_dm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizer: nmkb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N Individuals: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average Trial Numbers:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  168 trials comp; 168 trials incomp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cost Function: neg_log_like</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object Type: coefs_dm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID   muc     A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 4.595 0.081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2 6.843 0.114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (access the data.frame's columns/rows as usual)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
<span class="r-in"><span><span class="co"># Fit to aggregated data (using unbounded Nelder-Mead)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate_dm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  drift_dm_obj <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  obs_data <span class="op">=</span> <span class="va">data</span>, <span class="co"># contains data for two individuals</span></span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"Nelder-Mead"</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"agg_c"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the data supplied via the 'obs_data' argument.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using optimizer 'Nelder-Mead'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Changing the 'cost_function' to 'rmse'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregated data has been set to the model.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting the model once to the aggregated data. The returned object will of type 'fits_agg_dm'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing latin hypercube sampling (n_lhs = 10) on: muc, A</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting optimizer 'Nelder-Mead' with the following starting values:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> muc=5.843, A=0.222</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimization routine exited after 63 function evaluations</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Final Parameters:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> muc = 5.549</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A = 0.164</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ==&gt; gave a rmse of 0.025</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit approach: aggregated - classical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted model type: dmc_dm, drift_dm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizer: Nelder-Mead</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N Individuals: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average Trial Numbers:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  168 trials comp; 168 trials incomp</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       muc         A </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.5490172 0.1639635 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
<span class="r-in"><span><span class="co"># EXPERIMENTAL</span></span></span>
<span class="r-in"><span><span class="co"># Fit a single individual (using DE-MCMC; Bayesian; custom priors)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate_dm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  drift_dm_obj <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  obs_data <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"sep_b"</span>,</span></span>
<span class="r-in"><span>  burn_in <span class="op">=</span> <span class="fl">2</span>, <span class="co"># this is usually way higher</span></span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="fl">2</span>, <span class="co"># this too</span></span></span>
<span class="r-in"><span>  n_chains <span class="op">=</span> <span class="fl">10</span>, <span class="co"># this too</span></span></span>
<span class="r-in"><span>  mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>muc <span class="op">=</span> <span class="fl">3</span>, A <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>muc <span class="op">=</span> <span class="fl">2</span>, A <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the data supplied via the 'obs_data' argument.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using optimizer 'DE-MCMC'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting a single data set/participant using the Bayesian framework. The result will be a fit object of type 'mcmc_dm'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding starting values...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting the sampling procedure</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampler: DE-MCMC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hierarchical: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. Parameters: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. Chains: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations Per Chain: 2 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       muc         A </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.3807555 0.2611374 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###</span></span></span>
<span class="r-in"><span><span class="co"># EXPERIMENTAL</span></span></span>
<span class="r-in"><span><span class="co"># Fit multiple individuals (using DE-MCMC; hierarchical Bayesian)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">estimate_dm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  drift_dm_obj <span class="op">=</span> <span class="va">model</span>,</span></span>
<span class="r-in"><span>  approach <span class="op">=</span> <span class="st">"hier_b"</span>,</span></span>
<span class="r-in"><span>  obs_data <span class="op">=</span> <span class="va">data</span>, <span class="co"># contains data for two individuals</span></span></span>
<span class="r-in"><span>  burn_in <span class="op">=</span> <span class="fl">2</span>, <span class="co"># this is usually way higher</span></span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="fl">2</span>, <span class="co"># this too</span></span></span>
<span class="r-in"><span>  n_chains <span class="op">=</span> <span class="fl">10</span> <span class="co"># this too</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the data supplied via the 'obs_data' argument.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using optimizer 'DE-MCMC'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting the model hierarchically using a Bayesian framework. The result will be a fit object of type 'mcmc_dm'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding starting values...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting the sampling procedure</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampler: DE-MCMC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hierarchical: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. Group-Level Parameters: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. Chains: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations Per Chain: 2 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      M-muc      S-muc        M-A        S-A </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.23822502 3.41562477 0.08431614 0.81469557 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Valentin Koob, Thomas Richter, Markus Janczyk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

