<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>(Hierarchical) Bayesian Estimation with Differential Evolution — estimate_bayes_h • dRiftDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="(Hierarchical) Bayesian Estimation with Differential Evolution — estimate_bayes_h"><meta name="description" content="Estimate group-level and individual-level parameters with a
hierarchical Bayesian approach using Differential Evolution MCMC (DE-MCMC)
Turner et al. (2013)
.
An approximation of the marginal likelihood to calculate Bayes Factors can
be obtained with the Thermodynamic Integration via Differential Evolution
(TIDE) sampler Evans and Annis (2019)
."><meta property="og:description" content="Estimate group-level and individual-level parameters with a
hierarchical Bayesian approach using Differential Evolution MCMC (DE-MCMC)
Turner et al. (2013)
.
An approximation of the marginal likelihood to calculate Bayes Factors can
be obtained with the Thermodynamic Integration via Differential Evolution
(TIDE) sampler Evans and Annis (2019)
."><meta property="og:image" content="https://bucky2177.github.io/dRiftDM/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dRiftDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dRiftDM.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/convert_dmc_parameters.html">How to Convert DMC's parameters</a></li>
    <li><a class="dropdown-item" href="../articles/customize_ddms.html">How To Customize DDMs</a></li>
    <li><a class="dropdown-item" href="../articles/predictions_simple_ddm.html">Core DDM Parameters: Impact on RTs and Accuracy</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bucky2177/dRiftDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>(Hierarchical) Bayesian Estimation with Differential Evolution</h1>
      <small class="dont-index">Source: <a href="https://github.com/bucky2177/dRiftDM/blob/v0.3.0/R/core_bayes_estimate.R" class="external-link"><code>R/core_bayes_estimate.R</code></a></small>
      <div class="d-none name"><code>estimate_bayes_h.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate group-level and individual-level parameters with a
hierarchical Bayesian approach using Differential Evolution MCMC (DE-MCMC)
Turner et al. (2013)
.
An approximation of the marginal likelihood to calculate Bayes Factors can
be obtained with the Thermodynamic Integration via Differential Evolution
(TIDE) sampler Evans and Annis (2019)
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_bayes_h</span><span class="op">(</span></span>
<span>  <span class="va">drift_dm_obj</span>,</span>
<span>  <span class="va">obs_data_ids</span>,</span>
<span>  <span class="va">sampler</span>,</span>
<span>  <span class="va">n_chains</span>,</span>
<span>  <span class="va">burn_in</span>,</span>
<span>  <span class="va">samples</span>,</span>
<span>  <span class="va">n_cores</span>,</span>
<span>  <span class="va">prob_migration</span>,</span>
<span>  <span class="va">prob_re_eval</span>,</span>
<span>  <span class="va">verbose</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">estimate_bayes_one_subj</span><span class="op">(</span></span>
<span>  <span class="va">drift_dm_obj</span>,</span>
<span>  <span class="va">sampler</span>,</span>
<span>  <span class="va">n_chains</span>,</span>
<span>  <span class="va">burn_in</span>,</span>
<span>  <span class="va">samples</span>,</span>
<span>  <span class="va">prob_migration</span>,</span>
<span>  <span class="va">prob_re_eval</span>,</span>
<span>  <span class="va">verbose</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-drift-dm-obj">drift_dm_obj<a class="anchor" aria-label="anchor" href="#arg-drift-dm-obj"></a></dt>
<dd><p>an object of type <a href="drift_dm.html">drift_dm</a>.</p></dd>


<dt id="arg-obs-data-ids">obs_data_ids<a class="anchor" aria-label="anchor" href="#arg-obs-data-ids"></a></dt>
<dd><p>data.frame for the hierarchical case. An additional
column ID is necessary that codes the individuals (see also
<a href="obs_data.html">obs_data</a>).</p></dd>


<dt id="arg-sampler">sampler<a class="anchor" aria-label="anchor" href="#arg-sampler"></a></dt>
<dd><p>character string, indicating the sampler to use.
Must be either <code>"DE-MCMC"</code> (default) or <code>"TIDE"</code>.</p></dd>


<dt id="arg-n-chains">n_chains<a class="anchor" aria-label="anchor" href="#arg-n-chains"></a></dt>
<dd><p>numeric, number of chains for the MCMC-sampler.
Default is <code>40</code>.</p></dd>


<dt id="arg-burn-in">burn_in<a class="anchor" aria-label="anchor" href="#arg-burn-in"></a></dt>
<dd><p>numeric, number of burn-in iterations. Default is <code>500</code>.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>numeric, number of sampling iterations after burn-in.
Default is <code>2000</code>.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>numeric, number of threads to use for parallel processing in
the hierarchical case. Default is <code>1</code>.</p></dd>


<dt id="arg-prob-migration">prob_migration<a class="anchor" aria-label="anchor" href="#arg-prob-migration"></a></dt>
<dd><p>numeric, probability of performing a migration
crossover step during burn-in. Default is <code>0.1</code> (i.e., 10%).</p></dd>


<dt id="arg-prob-re-eval">prob_re_eval<a class="anchor" aria-label="anchor" href="#arg-prob-re-eval"></a></dt>
<dd><p>numeric, probability of re-evaluating the
likelihood/posterior values of the previous iteration <code>i-1</code> when deciding
for the acceptance of the proposal in iteration <code>i</code>. Only considered during
burn-in. Default is <code>0.1</code> (i.e., 10%).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>integer, indicating verbosity of output: 0 (none),
1 (minimal text output), or 2 (text output and progress bar). Default is <code>2</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>optional random seed for reproducibility.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to
<a href="get_default_prior_settings.html">get_default_prior_settings</a> to customize prior settings.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named ist containing posterior samples for
group-level and individual-level parameters, log-posterior values,
and log-likelihoods. Labels: <code>phi</code>, <code>pis_phi</code>, <code>lls_phi</code>, <code>theta</code>,
<code>pis_theta</code>, <code>lls_theta</code>. The first three entries are only present in the
hierarchical case.</p>
<p>The list also has an additional attribute named <code>data_model</code>. In the
hierarchical case, the attribute contains a named list of model copies
with all the individual data sets attached. The list is named according to
the individual <code>ID</code>s in the argument <code>obs_data_ids</code>. In the
non-hierarchical case, the attribute contains the model and its attached
data.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function <code>estimate_bayes_h()</code> handles the hierarchical case. The function
<code>estimate_bayes_one_subj()</code> handles the case for estimating a single
individual. The reason for writing two functions is that the hierarchical
case has some unique tweaks to it that need to be considered ... and writing
one function would be quite the mess.</p>
<p>Prior Settings: See the wrapper <code><a href="estimate_bayesian.html">estimate_bayesian()</a></code> and
also <code><a href="get_default_prior_settings.html">get_default_prior_settings()</a></code></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Turner BM, Sederberg PB, Brown SD, Steyvers M (2013).
“A method for efficiently sampling from distributions with correlated dimensions.”
<em>Psychological Methods</em>, <b>18</b>(3), 368–384.
<a href="https://doi.org/10.1037/a0032222" class="external-link">doi:10.1037/a0032222</a>
.

Evans NJ, Annis J (2019).
“Thermodynamic integration via differential evolution: A method for estimating marginal likelihoods.”
<em>Behavior Research Methods</em>, <b>51</b>, 930–947.
<a href="https://doi.org/10.3758/s13428-018-1172-y" class="external-link">doi:10.3758/s13428-018-1172-y</a>
.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Valentin Koob, Thomas Richter, Markus Janczyk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

