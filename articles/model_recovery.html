<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How To Perform a Model Recovery • dRiftDM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How To Perform a Model Recovery">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dRiftDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/dRiftDM.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/convert_dmc_parameters.html">How to Convert DMC's parameters</a></li>
    <li><a class="dropdown-item" href="../articles/customize_ddms.html">How To Customize DDMs</a></li>
    <li><a class="dropdown-item" href="../articles/model_recovery.html">How To Perform a Model Recovery</a></li>
    <li><a class="dropdown-item" href="../articles/predictions_simple_ddm.html">Core DDM Parameters: Impact on RTs and Accuracy</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bucky2177/dRiftDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How To Perform a Model Recovery</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bucky2177/dRiftDM/blob/v0.3.1/vignettes/model_recovery.Rmd" class="external-link"><code>vignettes/model_recovery.Rmd</code></a></small>
      <div class="d-none name"><code>model_recovery.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we demonstrate how to perform a model recovery
analysis. Model recovery is an important component of model validation,
particularly when we are interested in quantitatively comparing models.
The goal is to test whether different models can be distinguished from
one another based on the data they generate, ensuring that the models
are identifiable within a given model space. If, for example, model A
can also provide a good fit to data generated under models B or C, this
suggests that model A may be overly flexible. Such flexibility can limit
the generalizability of the model and make it difficult to disentangle
the competing models on a quantitative level.</p>
<p>A simple way to perform a model recovery analysis is to generate
synthetic data under each model and then fit each model to each data
set. To assess model recovery, we can track which model provides the
best fit to each data set, using a fit statistic that penalizes model
complexity <span class="citation">(Vandekerckhove, Matzke, and
Wagenmakers 2015)</span>, and summarize the results in a contingency
table—also known as a confusion matrix <span class="citation">(see
Wilson and Collins 2019)</span>.</p>
<p>Here, we provide demonstration code comparing the Ratcliff DDM with a
simplified version of the Diffusion Model for Conflict Tasks (DMC),
using a combination of and . As a fit statistic, we use the Bayesian
Information Criterion (BIC), although the same logic applies to other
fit indices that similarly balance goodness of fit and model complexity
<span class="citation">(see, e.g., Vandekerckhove, Matzke, and
Wagenmakers 2015)</span>.</p>
<p>First, we define each model and specify the parameter spaces used to
generate the synthetic data. Note that we need to slightly customize the
Ratcliff model (see ) so that it includes the same two conditions as the
DMC model (i.e., and ).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1.1) create the Ratcliff model and set new conditions</span></span>
<span><span class="va">ratcliff_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ratcliff_dm.html">ratcliff_dm</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/conds.html">conds</a></span><span class="op">(</span><span class="va">ratcliff_model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"comp"</span>, <span class="st">"incomp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; resetting parameter specifications</span></span>
<span></span>
<span><span class="co"># allow the drift rate to vary</span></span>
<span><span class="va">instructions</span> <span class="op">&lt;-</span> <span class="st">"muc ~ "</span></span>
<span></span>
<span><span class="va">ratcliff_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modify_flex_prms.html">modify_flex_prms</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">ratcliff_model</span>,</span>
<span>  instr <span class="op">=</span> <span class="va">instructions</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ratcliff_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Class(es) ratcliff_dm, drift_dm</span></span>
<span><span class="co">#&gt; (model has not been estimated yet)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Values:</span></span>
<span><span class="co">#&gt;        muc   b non_dec</span></span>
<span><span class="co">#&gt; comp     3 0.6     0.3</span></span>
<span><span class="co">#&gt; incomp   3 0.6     0.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Settings:</span></span>
<span><span class="co">#&gt;        muc b non_dec</span></span>
<span><span class="co">#&gt; comp     1 3       4</span></span>
<span><span class="co">#&gt; incomp   2 3       4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deriving PDFS:</span></span>
<span><span class="co">#&gt;   solver: kfe</span></span>
<span><span class="co">#&gt;   values: sigma=1, t_max=3, dt=0.0075, dx=0.02, nt=400, nx=100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cost Function: neg_log_like</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Observed Data: NULL</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># 1.2) now create DMC (without trial-by-trial variability in the starting point</span></span>
<span><span class="co"># and non-decision time; matching with the Ratcliff model)</span></span>
<span><span class="va">dmc_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dmc_dm.html">dmc_dm</a></span><span class="op">(</span>var_non_dec <span class="op">=</span> <span class="cn">FALSE</span>, var_start <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 1.3) create the parameter space for generating synthetic data</span></span>
<span><span class="va">lower_dmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>muc <span class="op">=</span> <span class="fl">2</span>, b <span class="op">=</span> <span class="fl">0.3</span>, non_dec <span class="op">=</span> <span class="fl">0.2</span>, tau <span class="op">=</span> <span class="fl">0.02</span>, A <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span>
<span><span class="va">upper_dmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>muc <span class="op">=</span> <span class="fl">6</span>, b <span class="op">=</span> <span class="fl">0.8</span>, non_dec <span class="op">=</span> <span class="fl">0.4</span>, tau <span class="op">=</span> <span class="fl">0.15</span>, A <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lower_ratcliff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>muc <span class="op">=</span> <span class="fl">2</span>, b <span class="op">=</span> <span class="fl">0.3</span>, non_dec <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">upper_ratcliff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>muc <span class="op">=</span> <span class="fl">6</span>, b <span class="op">=</span> <span class="fl">0.8</span>, non_dec <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<p>Note that the Ratcliff model in this demo comprises four parameters,
whereas the DMC model comprises five parameters.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ratcliff_model</span><span class="op">)</span></span>
<span><span class="co">#&gt;   muc.comp muc.incomp          b    non_dec </span></span>
<span><span class="co">#&gt;        3.0        3.0        0.6        0.3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">dmc_model</span><span class="op">)</span></span>
<span><span class="co">#&gt;     muc       b non_dec     tau       A </span></span>
<span><span class="co">#&gt;    4.00    0.60    0.30    0.04    0.10</span></span></code></pre></div>
<p>In a second step, we then generate data under both models. For each
model, we simulated <code>200</code> trials per condition and 10 data
sets. Critically, the small number of 10 data sets was chosen to ensure
that this vignette runs relatively fast! In practice, this number has to
be considerably higher! (e.g., <code>&gt;=100</code>). Also, the
<code>200</code> trials were chosen rather arbitrary. In practice,
choose the number of trials in accordance with the typical trial numbers
in your field and/or data sets! Finally, note that we initially
simulated more data under the Ratcliff model and then chose 10 data sets
with <code>muc</code> in <code>incomp</code> conditions being slightly
smaller than in <code>comp</code> condition. This ensures that the data
simulated under the Ratcliff model produces a reasonable congruency
effect.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Data generated under the Ratcliff model</span></span>
<span><span class="va">data_ratcliff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span></span>
<span>  <span class="va">ratcliff_model</span>, <span class="co">#  the model</span></span>
<span>  n <span class="op">=</span> <span class="fl">200</span>, <span class="co"># choose this value reasonably</span></span>
<span>  k <span class="op">=</span> <span class="fl">100</span>, <span class="co"># more data to filter afterwards</span></span>
<span>  lower <span class="op">=</span> <span class="va">lower_ratcliff</span>, <span class="co"># the lower parameter space for simulation</span></span>
<span>  upper <span class="op">=</span> <span class="va">upper_ratcliff</span> <span class="co"># the upper parameter space for simulation</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># choose data were the drift rate in incompatible conditions is</span></span>
<span><span class="co"># reasonably larger than in compatible conditions</span></span>
<span><span class="va">prms_ratcliff</span> <span class="op">&lt;-</span> <span class="va">data_ratcliff</span><span class="op">$</span><span class="va">prms</span></span>
<span><span class="va">diffs</span> <span class="op">&lt;-</span> <span class="va">prms_ratcliff</span><span class="op">$</span><span class="va">muc.comp</span> <span class="op">-</span> <span class="va">prms_ratcliff</span><span class="op">$</span><span class="va">muc.incomp</span></span>
<span><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">diffs</span> <span class="op">&lt;</span> <span class="fl">1.5</span> <span class="op">&amp;</span> <span class="va">diffs</span> <span class="op">&gt;</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">prms_ratcliff</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">filter</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">data_ratcliff</span> <span class="op">&lt;-</span> <span class="va">data_ratcliff</span><span class="op">$</span><span class="va">synth_data</span> <span class="co"># extract the data.frame of raw RTs</span></span>
<span><span class="va">data_ratcliff</span> <span class="op">&lt;-</span> <span class="va">data_ratcliff</span><span class="op">[</span><span class="va">data_ratcliff</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ids</span>, <span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="co"># Data generated under the DMC model</span></span>
<span><span class="va">data_dmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_data.html">simulate_data</a></span><span class="op">(</span></span>
<span>  <span class="va">dmc_model</span>, <span class="co">#  the model</span></span>
<span>  n <span class="op">=</span> <span class="fl">200</span>, <span class="co"># choose this value reasonably</span></span>
<span>  k <span class="op">=</span> <span class="fl">10</span>, <span class="co"># in practice, simulate more data sets!</span></span>
<span>  lower <span class="op">=</span> <span class="va">lower_dmc</span>, <span class="co"># the lower parameter space for simulation</span></span>
<span>  upper <span class="op">=</span> <span class="va">upper_dmc</span> <span class="co"># the upper parameter space for simulation</span></span>
<span><span class="op">)</span></span>
<span><span class="va">data_dmc</span> <span class="op">&lt;-</span> <span class="va">data_dmc</span><span class="op">$</span><span class="va">synth_data</span> <span class="co"># extract the data.frame of raw RTs</span></span></code></pre></div>
<p>To assess whether the simulated data are reasonably comparable across
conditions, we compute summary statistics of the mean RTs:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_stats.html">calc_stats</a></span><span class="op">(</span><span class="va">data_ratcliff</span>, type <span class="op">=</span> <span class="st">"basic_stats"</span>, level <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Type of Statistic: basic_stats</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Source   Cond Mean_corr Mean_err SD_corr SD_err P_corr</span></span>
<span><span class="co">#&gt; 1    obs   comp     0.424    0.445   0.062  0.036  0.984</span></span>
<span><span class="co">#&gt; 2    obs incomp     0.445    0.437   0.081  0.067  0.973</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (access the data.frame's columns/rows as usual)</span></span>
<span><span class="fu"><a href="../reference/calc_stats.html">calc_stats</a></span><span class="op">(</span><span class="va">data_dmc</span>, type <span class="op">=</span> <span class="st">"basic_stats"</span>, level <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Type of Statistic: basic_stats</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Source   Cond Mean_corr Mean_err SD_corr SD_err P_corr</span></span>
<span><span class="co">#&gt; 1    obs   comp     0.400    0.494   0.061  0.100  0.992</span></span>
<span><span class="co">#&gt; 2    obs incomp     0.436    0.401   0.069  0.056  0.950</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (access the data.frame's columns/rows as usual)</span></span></code></pre></div>
<p>In the third step, we fit each model to each data set. For parameter
estimation, we use Differential Evolution with two virtual cores and the
default parameter ranges that dRiftDM provides for each model out of the
box.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the parameter ranges for optimization</span></span>
<span><span class="co"># (adapt this if you have a custom model)</span></span>
<span><span class="va">l_u_ratcliff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lower_upper.html">get_lower_upper</a></span><span class="op">(</span><span class="va">ratcliff_model</span><span class="op">)</span></span>
<span><span class="va">l_u_dmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_lower_upper.html">get_lower_upper</a></span><span class="op">(</span><span class="va">dmc_model</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Fit the Ratcliff model to its data</span></span>
<span><span class="va">fits_r_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_dm.html">estimate_dm</a></span><span class="op">(</span></span>
<span>  drift_dm_obj <span class="op">=</span> <span class="va">ratcliff_model</span>,</span>
<span>  obs_data <span class="op">=</span> <span class="va">data_ratcliff</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"DEoptim"</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">l_u_ratcliff</span><span class="op">$</span><span class="va">lower</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">l_u_ratcliff</span><span class="op">$</span><span class="va">upper</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>, <span class="co"># you might want to increase this</span></span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  messaging <span class="op">=</span> <span class="fl">0</span> <span class="co"># suppresses all status infos</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the Ratcliff model to DMC's data</span></span>
<span><span class="va">fits_r_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_dm.html">estimate_dm</a></span><span class="op">(</span></span>
<span>  drift_dm_obj <span class="op">=</span> <span class="va">ratcliff_model</span>,</span>
<span>  obs_data <span class="op">=</span> <span class="va">data_dmc</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"DEoptim"</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">l_u_ratcliff</span><span class="op">$</span><span class="va">lower</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">l_u_ratcliff</span><span class="op">$</span><span class="va">upper</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>, <span class="co"># you might want to increase this</span></span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  messaging <span class="op">=</span> <span class="fl">0</span> <span class="co"># suppresses all status infos</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the DMC model to its data</span></span>
<span><span class="va">fits_d_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_dm.html">estimate_dm</a></span><span class="op">(</span></span>
<span>  drift_dm_obj <span class="op">=</span> <span class="va">dmc_model</span>,</span>
<span>  obs_data <span class="op">=</span> <span class="va">data_dmc</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"DEoptim"</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">l_u_dmc</span><span class="op">$</span><span class="va">lower</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">l_u_dmc</span><span class="op">$</span><span class="va">upper</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>, <span class="co"># you might want to increase this</span></span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  messaging <span class="op">=</span> <span class="fl">0</span> <span class="co"># suppresses all status infos</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the DMC model to the Ratcliff model's data</span></span>
<span><span class="va">fits_d_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_dm.html">estimate_dm</a></span><span class="op">(</span></span>
<span>  drift_dm_obj <span class="op">=</span> <span class="va">dmc_model</span>,</span>
<span>  obs_data <span class="op">=</span> <span class="va">data_ratcliff</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"DEoptim"</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">l_u_dmc</span><span class="op">$</span><span class="va">lower</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">l_u_dmc</span><span class="op">$</span><span class="va">upper</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>, <span class="co"># you might want to increase this</span></span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  messaging <span class="op">=</span> <span class="fl">0</span> <span class="co"># suppresses all status infos</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the fourth step, we determine, for each data set, which model
provides the better fit using the BIC fit statistic.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ratcliff model -&gt; Ratcliff data</span></span>
<span><span class="va">stats_r_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fits_r_r</span>, type <span class="op">=</span> <span class="st">"fit_stats"</span><span class="op">)</span></span>
<span><span class="co"># DMC model -&gt; Ratcliff data</span></span>
<span><span class="va">stats_d_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fits_d_r</span>, type <span class="op">=</span> <span class="st">"fit_stats"</span><span class="op">)</span></span>
<span><span class="co"># Ratcliff model -&gt; DMC data</span></span>
<span><span class="va">stats_r_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fits_r_d</span>, type <span class="op">=</span> <span class="st">"fit_stats"</span><span class="op">)</span></span>
<span><span class="co"># DMC model -&gt; DMC data</span></span>
<span><span class="va">stats_d_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fits_d_d</span>, type <span class="op">=</span> <span class="st">"fit_stats"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ensure the order of fits matches</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">stats_r_r</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">stats_d_r</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">stats_r_d</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">stats_d_d</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now count how often for each data set a model</span></span>
<span><span class="va">winner_ratcliff_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">stats_r_r</span><span class="op">$</span><span class="va">BIC</span> <span class="op">&lt;</span> <span class="va">stats_d_r</span><span class="op">$</span><span class="va">BIC</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">winner_ratcliff_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">winner_ratcliff_data</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">winner_dmc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">stats_r_d</span><span class="op">$</span><span class="va">BIC</span> <span class="op">&lt;</span> <span class="va">stats_d_d</span><span class="op">$</span><span class="va">BIC</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">winner_dmc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">winner_dmc_data</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we create a contingency table that quantifies the
``probability’’ that a given model fits a data set best, conditional on
which model generated the data (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">fit model</mtext><mo>∣</mo><mtext mathvariant="normal">sim model</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\text{fit model} \mid \text{sim model})</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert to proportions</span></span>
<span><span class="va">table_ratcliff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">winner_ratcliff_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table_dmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">winner_dmc_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assemble matrix</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">table_ratcliff</span>, <span class="va">table_dmc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sim_r"</span>, <span class="st">"sim_d"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fit_r"</span>, <span class="st">"fit_d"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span></span>
<span><span class="co">#&gt;       fit_r fit_d</span></span>
<span><span class="co">#&gt; sim_r   1.0   0.0</span></span>
<span><span class="co">#&gt; sim_d   0.2   0.8</span></span></code></pre></div>
<p>The resulting matrix shows that for data simulated under the Ratcliff
model, the Ratcliff model provided the best fit in all cases. For data
simulated under the DMC model, DMC provided the best fit in 80% of the
cases. Thus, in our small toy example, we demonstrate that the classical
Ratcliff DDM and the DMC model can be distinguished. This is important
because it shows that the non-stationary diffusion models implemented in
dRiftDM can be empirically discriminated from simpler, stationary
diffusion models.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Note that we also ran the same simulation using a higher
number of data sets. The results were very similar. The present
conclusion of discriminability is thus not merely due to a small number
of simulated data.&lt;/p&gt;"><sup>1</sup></a></p>
<p>We can go even a step further and convert the confusion matrix into
an <em>inversion matrix</em> <span class="citation">(see Wilson and
Collins 2019)</span>. Whereas the confusion matrix quantifies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">fit model</mtext><mo>∣</mo><mtext mathvariant="normal">sim model</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\text{fit model} \mid \text{sim model})</annotation></semantics></math>,
the inversion matrix quantifies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">sim model</mtext><mo>∣</mo><mtext mathvariant="normal">fit model</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\text{sim model} \mid \text{fit model})</annotation></semantics></math>—that
is, the probability that data best fit by a given model were actually
generated by another model. Assuming equal prior probabilities across
models, the inversion matrix can be obtained simply by re-normalizing
the confusion matrix across columns.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inversion_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="va">col</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">inversion_mat</span></span>
<span><span class="co">#&gt;           fit_r fit_d</span></span>
<span><span class="co">#&gt; sim_r 0.8333333     0</span></span>
<span><span class="co">#&gt; sim_d 0.1666667     1</span></span></code></pre></div>
<p>An important note at the end of this small model recovery example:
Model recovery depends strongly on the settings used to simulate and fit
the synthetic data. If, for example, the simulated parameters are
restricted to a narrow region in which the models under comparison
behave similarly, the resulting data may not vary enough to meaningfully
distinguish the models. Moreover, if the optimization routine is not
well-calibrated or if the simulated data do not reflect the
characteristics of the empirical data to which the models will later be
applied, the conclusions drawn from the recovery analysis may not
generalize to the actual model-fitting context. Thus, it is important to
stress that a model recovery should be designed to closely mirror the
conditions under which the models will ultimately be fitted to empirical
data.</p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Vandekerckhove2015book" class="csl-entry">
Vandekerckhove, Joachim, Dora Matzke, and Eric-Jan Wagenmakers. 2015.
<span>“Model Comparison and the Principle of Parsimony.”</span> In
<em>The Oxford Handbook of Computational and Mathematical
Psychology</em>, edited by Wang Busemeyer J. R., 300–319. Oxford
University Press. <a href="https://doi.org/10.1093/oxfordhb/9780199957996.013.14" class="external-link">https://doi.org/10.1093/oxfordhb/9780199957996.013.14</a>.
</div>
<div id="ref-WilsonCollins2019" class="csl-entry">
Wilson, Robert C, and Anne GE Collins. 2019. <span>“Ten Simple Rules for
the Computational Modeling of Behavioral Data.”</span> <em>eLife</em> 8:
e49547. <a href="https://doi.org/10.7554/eLife.49547" class="external-link">https://doi.org/10.7554/eLife.49547</a>.
</div>
</div>

  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Valentin Koob, Thomas Richter, Markus Janczyk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
